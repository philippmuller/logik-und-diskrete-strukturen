\section*{Blatt 7}
%

\subsection*{Aufgabe 1}
\begin{enumerate}[a)]
\item
\begin{align*}
 (1001)^{20} &= (1001)^{16} \cdot (1001)^{4}\\
             &= (1001)^{2^{4}} \cdot (1001)^{2^{2}}\\
\end{align*}

Rechnen wir die einzelnen Terme aus:

\begin{align*}
  (1001)^2 &= 2001 \mod 100000 \\
  (1001)^{2^{2}} = ((1001)^2)^2 = 2001^2 &= 4001 \mod 100000 \\
  (((1001)^2)^2)^2 = 4001^2 &= 8001 \mod 100000 \\
  (1001)^{2^{4}} = ((((1001)^2)^2)^2)^2 = 8001^2 &= 16001 \mod 100000 \\
\end{align*}

Daher können wir schreiben
\[  (1001)^{20} = (1001)^{2^{4}} \cdot (1001)^{2^{2}} \underbrace{=}_{\text{mit mod}} 8001 \cdot 16001 = 24001 \mod 100000 \]

Dies sind die letzten 5 Stellen der Dezimaldarstellung.


\item

Aufgrund von \[ (1+x)^n = 1 + \binom{n}{1}x + \binom{n}{2}x^2 + \cdots + \binom{n}{n} x^n  \]

haben wir $p_4 = \binom{n}{4} $ und $q_2= \binom{n}{2}  $.

Daher lösen wir

\begin{align*}
p_4 = 6q_2 &\iff \binom{n}{4} = 6 \binom{n}{2} \\
           &\iff \frac{n!}{ (n-4)! 4! } =  6 \frac{n!}{(n-2)! 2!}\\
           &\iff \frac{n!}{24(n-4)!} = \frac{3n!}{(n-2)!} \\
           &\iff \frac{1}{24} (n-3)(n-2)(n-1)n = 3(n-1)n \\
           &\iff n^2 + 11 = 12n \\
           &\implies n = \frac{12 \pm \sqrt{144 - 44}}{2} \\
           &n = 11
\end{align*}

Alle anderen möglichen Lösungen sind wegen Vorraussetzung $n\geq 2$ ungültig.

\end{enumerate}


\subsection*{Aufgabe 2}

\[ \sum_{k=1}^{n} k\binom{n}{k} = n \cdot 2^{n-1} \]
n=0:

\begin{align*}
\sum_{k=1}^{0} k\binom{0}{k} &= 0 \cdot 2^{0-1}  \\
1\binom{0}{1} &= 0 \\
1 \cdot 0 &= 0  \\
\end{align*}

n = n + 1:

\[ \sum_{k=1}^{n+1} k\binom{n+1}{k} = (n+1)2^{n}  \]

Forme nun LHS zu RHS um:

\begin{align*}
& \iff (n+1)\binom{n+1}{n+1} + \sum_{k=1}^{n}k\binom{n+1}{k} \\
& \iff (n+1) + \sum_{k=1}^{n}k\binom{n}{k} + \sum_{k=1}^{n}k\binom{n}{k-1} \\
& \iff (n+1) + \sum_{k=1}^{n}k\binom{n}{k} + \sum_{k=1}^{n}(k-1)\binom{n}{k-1} + \sum_{k=1}^{n}\binom{n}{k-1} \\
& \iff (n+1) + \sum_{k=1}^{n}k\binom{n}{k} + \sum_{k=0}^{n-1}k\binom{n}{k} + n^{2} - 1 \\
& \iff (n+1) + \sum_{k=1}^{n}k\binom{n}{k} + \sum_{k=1}^{n}k\binom{n}{k} - n\binom{n}{n} + n^{2} - 1 \\
& \iff (n+1) + 2\bp{\sum_{k=1}^{n}k\binom{n}{k}} - n + n^{2} - 1 \\
& \iff 2\bp{\sum_{k=1}^{n}k\binom{n}{k}} + n^{2} \\
& \iff 2(n2^{n-1}) + n^{2} \\
& \iff n2^{n} + n^{2} \\
& \iff (n+1)2^{n} \\
\end{align*}


% ----------------------------

\subsection*{Aufgabe 3}
\begin{enumerate}[a)]
\item
Jeder Weg vom Start zum Ziel besteht aus genau $n+k-2$ Schritten, $k-1$ Schritte nach oben und $n-1$ Schritte nach rechts, und die Reihenfolge beliebig ist. Man also in jedem Schritt entscheiden, nach oben zu gehen, solange deren Summe $k-1$ ist. Die Anzahl an Wegen ist somit gegeben durch

\[  N_1 = \binom{n+k-2}{k-1} \].

Aufgrund der Symmetrie des Binomialkoeffizienten könnte man $k-1$ auch durch $n-1$ ersetzen.

\item
Es führen $\binom{10+10-2}{5-1} = \binom{18}{4}$ Wege zu (10, 10). Jeder dieser Wege könnte auf $\binom{n+k-18}{k-4}$ Wege forgeführt werden. Damit gibt noch es
\[  N_2 = \binom{n+k-2}{k-1} -  \binom{n+k-18}{k-4}\binom{18}{4} \]
Wege.

\item
Die Anzahl der Wege, die in einem Punkt $(x,y)$ mit $y = n$ enden
und die keinen weiteren Punkt $(x', y')$ mit $y' = n$ enthalten, ist gleich der Anzahl der Wege die zu $(x, y)$ mit $y = n -1$ führen, da von dort aus ein Schritt nach rechts den Weg beendet. Somit ist die Anzahl gegeben durch

\[  N_3 = \sum_{k=1}^{n}\binom{n+k-3}{k-1} \].

Statt bis $n$ gehen wir nur noch bis $n-1$, daher haben wir oben $n+k-3$ anstatt $n+k-2$.


\end{enumerate}


% ----------------------------

\subsection*{Aufgabe 4}
\begin{enumerate}[a)]
  \item Wir bekommen die Wahrscheinlichkeit, indem wir die Häufigkeit mit der gesamte Anzahl an Möglichkeiten vergleichen. Für einen Vierling haben wir 13 mögliche Hände und 48 Möglichkeiten für die fünfte Karte. Somit gibt es $13 \cdot 48$ Möglichkeiten hierfür.

  Für alle möglichen Hände in five-card-draw haben wir $\frac{52!}{47!}$. Weil wir auf Reihenfolge achten müssen, müssen wir noch durch $5!$ teilen und es ergibt sich $52! / 47! / 5! = 2 598 960$, da $5!$ die tatsächlich möglichen Zusammensetzungen jener 5 Karten angibt.

  Daher haben wir für die Wahrscheinlichkeit $\frac{624}{2 598 960} = 0.0002400960384 = 0.024 \%$.

  \item Es gibt 4 Farben und 13 Karten innerhalb jener. Daher haben wir \[ \binom{4}{1} \binom{13}{5} = 5148 \]

  Vergleichen wir dies mit allen Möglichkeiten ergibt sich als Wahrscheinlichkeit $5 148 / 2598960=0.001980792317$.

  \item Wenn der Spieler mindestens 3 Asse zu Ende haben muss und zu Austeilen mindestens eins hat, kann er nach dem Austeilen entweder 1, 2 , 3 oder 4 Asse halten, zusätzlich hält er jeweils noch andere Karten. Gegeben wieviele Asse der Spieler nach dem Austeilen hielt müssen wir berechnen, wie seine Wahrscheinlichkeit ist, nach dem Ablegen genug Asse zu ziehen um am Ende mindestens 3 zu halten.

  Es ergeben sich also folgende Bedingungen:

  \begin{tabular}{c c c c}
    Fall & Nach Austeilen & Abgelegt werden & fehlende Asse für $\geq 3$\\
    \hline
    1 & 1 Ass & 4 Karten & $\geq 1$ Ass \\
    2 & 2 Asse & 3 Karten & $\geq 2$ Asse \\
    3 & 3 Asse & 2 Karten & keine \\
    4 & 4 Asse & 1 Karte & keine \\
  \end{tabular}

  Gehen wir nun die Wahrscheinlichkeiten für die einzelnen Fälle durch. Das Ergebnis erhalten wir später durch aufsummieren, da die einzelnen Ereignisse unabhängig sind.

  Wir werden erst schreiben, welche Wahrscheinlichkeit das jeweilige Blatt hat (1 Ass, 2 Asse usw.) und dann die Wahrscheinlichkeit multiplizieren, dass nach dem Ablegen noch genug Asse gezogen werden um mindestens 3 vorliegen zu haben. Letztere Wahrscheinlichkeiten sind konditional zu dem früheren Blatt, manche Karten sind also nicht mehr verfügbar.

  \begin{enumerate}
    \item
      \begin{align*}
        \br{\frac{\binom{4}{1} \binom{48}{4} }{ \binom{52}{5} }} &\cdot P(\geq \text{2 Asse}) \\
                                    &= 1 - P(\text{0 Asse}) \cup P(\text{1 Ass})\\
                                    &\underbrace{=}_{\text{Unabhängigkeit}} 1 - P(\text{0 Asse}) + P(\text{1 Ass})\\
                                    &= 1- \br{ \underbrace{\frac{\binom{44}{4}}{\binom{47}{4}}}_{\text{0 Asse}} +
                                        \frac{ \overbrace{\binom{3}{1}}^{\text{1 Ass fehlt}} \overbrace{\binom{44}{3}}^{\text{restliche 3 Karten ohne Asse}}}{ \binom{47}{4} } }\\
      \end{align*}
    \item
      \begin{align*}
        \br{ \frac{ \binom{4}{2} \binom{12}{3} \binom{4}{1}^{3} }{ \binom{52}{5} }  }
                &\cdot \br{ 1 - \underbrace{\frac{ \binom{45}{3} }{\binom{47}{3} }}_{\text{P(0 Asse)}} }
      \end{align*}

    \item
      \begin{align*}
        \br{ \frac{ \binom{4}{3} \binom{12}{2} \binom{4}{1}^{2} }{\binom{52}{5}} }
          &\cdot \br{ \binom{12}{1} \binom{4}{1}^{2}{\binom{47}{2}} }
      \end{align*}
    \item
      \begin{align*}
        \br{ \frac{ \binom{4}{4} \binom{12}{1} \binom{4}{1} }{\binom{52}{5}} }
            &\cdot \br{\frac{\binom{12}{1}}{\binom{47}{1}}}
      \end{align*}

    Dies liefert für die gesamte Wahrscheinlichkeit 0.00919164791085, also 0,919164791085\%.
    Ausgerechnet mit folgendem Code (Python3.4):

    \begin{verbatim}
import scipy.special as sp

first = (sp.binom(4,1) * sp.binom(48,4)) / (sp.binom(52,5))

first_2 = 1 - ((sp.binom(44,4) + sp.binom(3,1) * sp.binom(44,3))
  / (sp.binom(47,4)))

second = (sp.binom(4,2) * sp.binom(12,3) * sp.binom(4,1)**3)
  / (sp.binom(52,5))

second_2 = 1 - (sp.binom(45,3) / sp.binom(47,3))

third = (sp.binom(4,3) * sp.binom(12,2) * sp.binom(4,1)**2)
  / (sp.binom(52,5))

third_2 = (sp.binom(12,1) * sp.binom(4,1)**2) / (sp.binom(47,2))

forth = (sp.binom(4,4) * sp.binom(12,1) * sp.binom(4,1))
  / (sp.binom(52,5))

forth_2 = (sp.binom(12,1)) / (sp.binom(47,1))

result = first*first_2 + second*second_2 + third*third_2 + forth*forth_2

print(result)
    \end{verbatim}

  \end{enumerate}

\end{enumerate}

      % automata stuff
      % \begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=2cm]
      % \node[initial,state,accepting]  (q0)     {$q_0$};
      % \node[state, accepting]  (q1) [right of=q0]  {$q_1$};
      % \node[state, accepting]  (q2) [right of=q1] {$q_2$};
      % \node[state, accepting]  (q3) [right of=q2]  {$q_3$};
      % \node[state, accepting]  (q4) [right of=q3] {$q_4$};

      % \path[->] (q0) edge [loop above] node {0} (q0)
      %            edge              node {1} (q1)
      %       (q1) edge [loop above] node {0} (q1)
      %            edge              node {1} (q2)
      %       (q2) edge [loop above] node {0} (q2)
      %            edge              node {1} (q3)
      %       (q3) edge [loop above] node {0} (q3)
      %            edge              node {1} (q4)
      %       (q4) edge [loop above] node {0} (q4)
      %       ;
      % \end{tikzpicture}



      % more automata stuff
      % \begin{tikzpicture}[>=stealth',shorten >=1pt,auto,node distance=2cm]
      % \node[initial,state,accepting]  (q0)     {$q_0$};
      % \node[state, accepting]  (q1) [right of=q0]  {$q_1$};


      % \path[->] (q0) edge [loop above] node {1} (q0)
      %            edge              node {0} (q1)
      %       (q1) edge [bend left]  node {1} (q0)

      %       ;
      % \end{tikzpicture}
